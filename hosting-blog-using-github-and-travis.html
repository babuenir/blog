<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Hosting blog using Github and Travis</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Serif+Pro:400,700">
    <link rel="stylesheet" type="text/css" href="https://babuenir.github.io/blog/theme/css/main.css">
    <script src="https://use.fontawesome.com/76ac647053.js"></script>
</head>
<body itemscope itemtype="http://schema.org/Blog">
<header class="site-header">
    <a href="https://babuenir.github.io/blog">
        <img src="https://babuenir.github.io/blog/static/images/babuenir.png" alt="Babuenir" title="Babuenir">
    </a>
    <h1 itemprop="name"><a href="https://babuenir.github.io/blog">BABUENIR</a></h1>
<p class="subtitle">Random musings on the universe</p>    <br />
    <div>
      <a class="button" href="https://babuenir.github.io/blog/category/technology.html">Technology</a>&nbsp;
      <a class="button" href="https://babuenir.github.io/blog/category/art.html">Art</a>&nbsp;
      <a class="button" href="https://babuenir.github.io/blog/category/literature.html">Literature</a>
    </div>
</header>
    <main>
    <section class="main-content">
<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="headline" id="hosting-blog-using-github-and-travis">Hosting blog using Github and Travis</h1>
        <p>
            <meta itemprop="datePublished" content="2016-11-03T00:00:00+05:30">
            <meta itemprop="dateModified" content="2016-11-03T00:00:00+05:30">
            <meta itemprop="image" content="https://secure.gravatar.com/avatar/aaf9dadf96ba3361de25e04a6c9fdfc3">
            Posted on 03 November 2016 in <a href="https://babuenir.github.io/blog/category/technology.html">Technology</a>
        </p>
        <p class="shareicons"><a href="http://www.addtoany.com/share_save?linkurl=https://babuenir.github.io/blog/hosting-blog-using-github-and-travis.html"><i class="fa fa-plus-square" style="padding-right:5px;"></i>Share: </a><a href="http://www.facebook.com/share.php?u=https://babuenir.github.io/blog/hosting-blog-using-github-and-travis.html"><i class="fa fa-facebook-square" style="padding-right:5px"></i></a><a href="http://twitter.com/share?url=https://babuenir.github.io/blog/hosting-blog-using-github-and-travis.html"><i class="fa fa-twitter-square" style="padding-right:5px"></i></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://babuenir.github.io/blog/hosting-blog-using-github-and-travis.html"><i class="fa fa-linkedin-square" style="padding-right:5px;"></i></a><a href="https://plus.google.com/share?url=https://babuenir.github.io/blog/hosting-blog-using-github-and-travis.html"><i class="fa fa-google-plus-square" style="padding-right:5px;"></i></a></p>
    </header>
    <section id="content" itemprop="mainEntityOfPage">
        <hr class="docutils" />
<div class="section" id="story-so-far">
<h2>Story so far</h2>
<p>It is already discussed about how one can write their thoughts out
just in a text document in the previous article <a class="reference external" href="https://babuenir.github.io/blog/pelican-based-blogging.html">here</a>.  The
topics, what is Pelican, then the commandline to kickstart a blogging
site locally are discussed. In this article, hosting the source code
of the blog and the blog using github and automate the build using
Travis-CI will be explained.</p>
</div>
<div class="section" id="github-hosting">
<h2>Github hosting</h2>
<p>An enormous number of projects hosted in Github. It is a wonderful
platform for anyone to place their code over there. Options are
available to make the project public as well as private. For an
instance, this blog is available as a public Github project. This is
written as a text document and Pelican is used to convert the text
document into a html document applying the theme on it. FYI, this blog
is under MIT license, which means it is open source.</p>
<p>For those who are familiar to git, can jump in to handle checking in
and checking out the source for the blog easily. For the newbies to
git, please refer the cheat sheet to start with git usage <a class="reference external" href="https://services.github.com/kit/downloads/github-git-cheat-sheet.pdf">here</a>.</p>
</div>
<div class="section" id="the-flow">
<h2>The Flow</h2>
<p>I'm going to introduce a new term here. Github along with this Travis
is going to do some magic, called &quot;Continuous Integration&quot;. The user
has to write their blog content and push it to their corresponding
repository. Once this is done a few settings here and there will make
the Travis CI to pull the content from master branch of the user's
repository and convert them into web articles with a theme mentioned
in the Pelican configuration. Later the output will be pushed to the
gh-pages branch of the same repository. The below illustration show
how things are happening.</p>
<p><img alt="Travis-Github" src="static/images/travis-github-flow.png" style="width: 800px;" /></p>
<p>Travis CI uses the Github account to signing in. <a class="reference external" href="https://travis-ci.org">https://travis-ci.org</a>
is the url to access Travis. In the user repository, a file
'.travis.yml' needs to be added. So that a build will be triggered
every time a commit is done on the repository. The sample file is below.</p>
<pre class="code literal-block">
language: python
python:
  - '2.7'
script: echo &quot;Hello World!&quot;
</pre>
<p>Travis provides a stable version of Ubuntu machine instance, in which
the project dependenices are installed and built, the way it is
mentioned in the '.travis.yml' file.</p>
</div>
<div class="section" id="what-goes-where">
<h2>What goes where?</h2>
<p>The user has to create an account and a repository in Github. The link
<a class="reference external" href="https://github.com/new">https://github.com/new</a> will create a repository or clicking the &quot;New
Repository&quot; button in the home page will create it. Proceed to fill up
the different information like repository name, license, readme text
and so on. After this clone the repository to the local machine using
git commands.</p>
<pre class="code bash literal-block">
~<span class="nv">$ </span>git clone https://github.com/&lt;username&gt;/&lt;project-name&gt;.git
</pre>
<p>After this, the user has to make some settings. These are kind of a
deal between Travis and Github. All of the user's content will fall
into the 'master' branch in their Github repository. The user has to
create an empty branch named 'gh-pages' in the repository. The user
has to install Travis. This can be done using &quot;gem&quot;, since it is a
ruby package. For a Linux based system, the following commands will
install ruby and travis along,</p>
<pre class="code bash literal-block">
~<span class="nv">$ </span>sudo apt-get install ruby-full
~<span class="nv">$ </span>sudo gem install travis
</pre>
<p>After this is done, the user can go ahead to Github settings and
create an access token, from the url
<a class="reference external" href="https://github.com/settings/tokens/new">https://github.com/settings/tokens/new</a>. The name for the token
as description has to be provided and full control to the repo needs
to be enabled by clicking the first checkbox as below.</p>
<img alt="" src="static/images/github-api-access-token.png" style="width: 800px;" />
<p>Then clicking the generate token button will jump to a page with the
generated token. The token has to be saved somewhere. If it is not
saved, no armagedon ahead; it can be regenerated. But it has to be updated
in every application/deployment, in which the token has been used. Now
the token has to be passed to the Travis cli to encrypt it and add it
to the '.travis.yml' automagically.</p>
<pre class="code bash literal-block">
~<span class="nv">$ </span>travis login
Shell completion not installed. Would you like to install it now? |y| y
We need your GitHub login to identify you.
This information will not be sent to Travis CI, only to api.github.com.
The password will not be displayed.

Try running with --github-token or --auto <span class="k">if </span>you don<span class="err">'</span>t want to enter your password anyway.

Username: &lt;username&gt;
Password <span class="k">for</span> &lt;username&gt;: ************
Successfully logged in as &lt;username&gt;
~<span class="err">$</span>
~<span class="err">$</span>
~<span class="nv">$ </span>travis encrypt <span class="nv">GITHUB_TOKEN</span><span class="o">=</span>b892442cfd48a31b41eb0f09c72224a1a0edd880
Detected repository as &lt;username&gt;/&lt;project&gt;, is this correct? |yes|
Please add the following to your .travis.yml file:

  secure: <span class="s2">&quot;pAHsoCLYYsZwMQJyNAae2riKF+K5QSty3cEYja/ESXddW8/yjS1xRXzVlcLPZlisqy1nBe9ZM/jggTbLdNYgtxg3v0hBj88TWD/CMt3WlgfUdEF5qOgs61GAB6vDgXFT/JA2azkoaVdKRPExRw9qGhnkzIJcZAzmMOD46cr37Zuw8ZHcCvVPBxxDkqS1YAePe5xK7i1x5XaC49WyOcEblnQN+eWBn7YjcT4IXNA2kZCJ85rZ/AYmWo8aICp8G/gP3QtzDFs1heORJiFM02q6hX+MVbDVcl1F9NXyoCVU6TiJSj6Qg8yM56XOqQZG6HOgJtJBhZXy8YG5hIE4wCoGx+WTdgqjd2JlhEaiUYF/b1ooKcMwtkkPOMNnQiKtrD5b5XRmqmqg5qAouavjN2BY+lZQdY7Hpn/JCJm3rL1gNhDTsNgaIc59H0sxlMfyLfOZeFsHhiaxoR8Ts4N+pzVqiQChjTO9CLulGm7qDPzJkAEjPPS/SsVqVTllbaY/HFfyEaFIt+jA5UQobxxj4IT3l2G/PF8oZwEbXIpEaJHr8sT7ux7MqlOLlsLrItMjAzNMm4P9Z4kNN4N12aDjellAdbAPZAhqnugZ0aLmHQklj141a4BnSHHuCSocFUHuN/ZDVkHiFXUvTdmzeSOUnhMnvVl4ho+3eSYOsznPiuSqc54=&quot;</span>

Pro Tip: You can add it automatically by running with --add.
~<span class="err">$</span>
~<span class="err">$</span>
~<span class="nv">$ </span>travis encrypt <span class="nv">GITHUB_TOKEN</span><span class="o">=</span>b892442cfd48a31b41eb0f09c72224a1a0edd880 --add
~<span class="err">$</span>
</pre>
<p>That's it. An example '.travis.yml' is as follows, it has the secure
environment variable that enables travis to automatically push output
from building the Pelican blog to 'gh-pages' branch.</p>
<pre class="code literal-block">
language: python
python:
- '2.7'
before_install:
- sudo apt-get update -qq
install:
- pip install -r requirements.txt
script:
- make clean
- make html
env:
  global:
  - secure: pAHsoCLYYsZwMQJyNAae2riKF+K5QSty3cEYja/ESXddW8/yjS1xRXzVlcLPZlisqy1nBe9ZM/jggTbLdNYgtxg3v0hBj88TWD/CMt3WlgfUdEF5qOgs61GAB6vDgXFT/JA2azkoaVdKRPExRw9qGhnkzIJcZAzmMOD46cr37Zuw8ZHcCvVPBxxDkqS1YAePe5xK7i1x5XaC49WyOcEblnQN+eWBn7YjcT4IXNA2kZCJ85rZ/AYmWo8aICp8G/gP3QtzDFs1heORJiFM02q6hX+MVbDVcl1F9NXyoCVU6TiJSj6Qg8yM56XOqQZG6HOgJtJBhZXy8YG5hIE4wCoGx+WTdgqjd2JlhEaiUYF/b1ooKcMwtkkPOMNnQiKtrD5b5XRmqmqg5qAouavjN2BY+lZQdY7Hpn/JCJm3rL1gNhDTsNgaIc59H0sxlMfyLfOZeFsHhiaxoR8Ts4N+pzVqiQChjTO9CLulGm7qDPzJkAEjPPS/SsVqVTllbaY/HFfyEaFIt+jA5UQobxxj4IT3l2G/PF8oZwEbXIpEaJHr8sT7ux7MqlOLlsLrItMjAzNMm4P9Z4kNN4N12aDjellAdbAPZAhqnugZ0aLmHQklj141a4BnSHHuCSocFUHuN/ZDVkHiFXUvTdmzeSOUnhMnvVl4ho+3eSYOsznPiuSqc54=
after_success:
- bash deploy.sh
</pre>
<p>The above '.travis.yml' file is explained as,</p>
<table border="1" class="no-border docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr><td>language</td>
<td>the language that this project uses, Travis will install it.</td>
</tr>
<tr><td>python</td>
<td>since this project uses python, followed by version 2.7.</td>
</tr>
<tr><td>before_install</td>
<td>things to be done before installing any packages.</td>
</tr>
<tr><td>install</td>
<td>list of packages to be installed.</td>
</tr>
<tr><td>script</td>
<td>steps/commands to be used to build this project.</td>
</tr>
<tr><td>env</td>
<td>list of environment variables used by Travis. Here secure.</td>
</tr>
<tr><td>after_success</td>
<td>steps/scripts to be run after build passes.</td>
</tr>
</tbody>
</table>
<p>Note that there is a line at 'after_success' step. The script is as
follows used to push the built output from the Travis work area to
Github.</p>
<pre class="code bash literal-block">
<span class="c">#!/bin/bash
</span>
<span class="nb">set</span> -o errexit -o nounset

<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$TRAVIS_BRANCH&quot;</span> !<span class="o">=</span> <span class="s2">&quot;master&quot;</span> <span class="o">]</span>
<span class="k">then
  </span><span class="nb">echo</span> <span class="s2">&quot;This commit was made against the $TRAVIS_BRANCH and not the master! No deploy!&quot;</span>
  <span class="nb">exit </span>0
<span class="k">fi

</span><span class="nv">rev</span><span class="o">=</span><span class="k">$(</span>git rev-parse --short HEAD<span class="k">)</span>

<span class="nb">cd </span>output

git init
git config --global user.name <span class="s2">&quot;&lt;username&gt;&quot;</span>
git config --global user.email <span class="s2">&quot;&lt;username&#64;example.com&gt;&quot;</span>

git remote add upstream <span class="s2">&quot;https://$GH_TOKEN&#64;github.com/&lt;username&gt;/&lt;project-name&gt;.git&quot;</span>
git fetch upstream
git reset upstream/gh-pages

touch .

git add -A .
git commit -m <span class="s2">&quot;rebuild pages at ${rev}&quot;</span>
git push -q upstream HEAD:gh-pages
</pre>
<p>Okay! Now the user has to login Travis site and configure the build
settings over there. In the link,
<a class="reference external" href="https://travis-ci.org/profile/username">https://travis-ci.org/profile/username</a> select the project to be built,
a toggle button as below,</p>
<img alt="" src="static/images/travis-enable-build.png" style="width: 500px;" />
<p>Then enable the project build settings as follows,</p>
<img alt="" src="static/images/travis-build-settings.png" style="width: 500px;" />
</div>
<div class="section" id="happy-hosting">
<h2>Happy Hosting!</h2>
<p>This is the end of the story. With all these settings in place, a blog
or any project can be deployed as wished using the duo, Github and
Travis. This blog is available in Github, so that anyone who wants to
have a reference setup can take a look at that to start with.</p>
<p>Cheers.</p>
<hr class="docutils" />
</div>

    </section>
    <footer>
        <div class="tags">
                <a href="https://babuenir.github.io/blog/tag/pelican.html">Pelican</a>
                <a href="https://babuenir.github.io/blog/tag/travis.html">Travis</a>
                <a href="https://babuenir.github.io/blog/tag/github.html">Github</a>
                <a href="https://babuenir.github.io/blog/tag/how-to.html">How-to</a>
        </div>
<div class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <a href="https://babuenir.github.io/blog/author/babusubashchandar.html">
        <img class="photo circle" itemprop="image" content="https://secure.gravatar.com/avatar/aaf9dadf96ba3361de25e04a6c9fdfc3" src="https://secure.gravatar.com/avatar/aaf9dadf96ba3361de25e04a6c9fdfc3"/>
        <strong class="fn name" itemprop="name">BabuSubashChandar</strong>
    </a>
</div>    </footer>
    <div class="comments">
      <h4>Comments</h4>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "hosting-blog-using-github-and-travis.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://babuenir.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
</article>
    </section>
    </main>

<footer class="about">
  <div class="main-content">
    <h4>About</h4>
    <div class="about-img">
      <img class="photo circle" itemprop="image" content="https://secure.gravatar.com/avatar/aaf9dadf96ba3361de25e04a6c9fdfc3" src="https://secure.gravatar.com/avatar/aaf9dadf96ba3361de25e04a6c9fdfc3"/>
      <br>
    </div>
    <div class="about-info">
      <p>BabuSubashChandar is an Open Source Software enthusiast,
Embedded Systems Engineer and trainer by profession, an ardent lover of
arts and science. This is his personal blog, where you can find his
experiences and works related to GNU/Linux, Embedded Systems,
Literature, Paintings, and so on.
</p>
      <p><a class="button" href="https://babuenir.github.io/blog/profile.html" target="_blank">View Profile</a></p>
    </div>
  </div>
  <div class="social">
    <h5>Social</h5>
    <ul class="categories">
      <li><a href="https://github.com/babuenir"><i class="fa fa-github-square fa-3x"></i></a></li>
      <li><a href="https://twitter.com/babuenir"><i class="fa fa-twitter-square fa-3x"></i></a></li>
      <li><a href="https://www.linkedin.com/in/babuenir"><i class="fa fa-linkedin-square fa-3x"></i></a></li>
    </ul>
  </div>
</footer><script type="text/javascript">
    var disqus_shortname = 'babuenir';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<footer class="site-footer">
  <div>&copy; BabuSubashChandar </div>
  <p>Powered by <a href="https://getpelican.com/">Pelican.</a></p>
</footer>    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-85783055-1', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>